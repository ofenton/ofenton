#!/usr/bin/env python
import sys
import os
import stashy
 
stash = stashy.connect("URL", "USERNAME", "PASSWORD")
print stash
print stash.projects

for p in stash.projects.list():
    project = p["key"].lower()
    print project
    
    if (not os.path.isdir("./" + project)):
        os.mkdir("./" + project)
        os.chdir(project)
        for repo in stash.projects[project].repos.list():
            for url in repo["links"]["clone"]:
                if (url["name"] == "http"):
                    os.system("git clone %s" % url["href"])
                    break
        os.chdir("..")
